# Task 2.2: Configure WireGuard Server

**Objective**: Create and configure WireGuard server instance on OPNsense.

**Steps**:
1. In OPNsense: **VPN → WireGuard → Instances**
2. Click **Add** button to create a new WireGuard instance
3. Configure the instance:
   - **Name**: `wg0` (standard WireGuard naming - avoids confusion with hostname)
   - **Listen Port**: `51820` (default WireGuard port)
   - **Tunnel Address**: `10.10.0.1/24` (VPN network gateway IP)
   - **Depend on (CARP)**: Leave empty/unchecked (CARP is only for high-availability setups with multiple firewalls)
   - **Private Key**: Click **Generate** button to create a new key pair
   - **Public Key**: Will be generated automatically after generating private key
   - **Description**: `WireGuard VPN Server` (optional)
4. Click **Save**

**CARP Explanation**:
- **CARP** (Common Address Redundancy Protocol) is for high-availability setups
- Used when you have multiple OPNsense firewalls in a failover configuration
- For a single OPNsense setup (typical homelab), leave this empty/unchecked
- Only enable if you have a redundant firewall setup

**Tunnel Address Explanation**:
- **Tunnel Address**: `10.10.0.1/24` is the IP address for the WireGuard server on the VPN network
- This is the gateway IP that VPN clients will connect to
- The `/24` means the VPN network is `10.10.0.0/24`
- VPN clients will get IPs like `10.10.0.2`, `10.10.0.3`, etc.

**Note**: 
- The private/public key pair is generated automatically when you click **Generate**
- Save the public key - you'll need it for the endpoint configuration (Task 2.8)
- The instance will be created but not yet assigned to an interface (that's Task 2.3)

**Test**:
```bash
# Check WireGuard instance exists
# Navigate to: VPN → WireGuard → Instances
# Should see your instance listed (e.g., wg0)

# Check WireGuard status
# Navigate to: VPN → WireGuard → Status
# May not show interface yet (will appear after Task 2.3)
```

**Expected Result**: WireGuard instance is created with a key pair generated.
